<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Diffing contents of docker containers &middot;  Matt Carrier" />
  
  <meta property="og:site_name" content="Matt Carrier" />
  <meta property="og:url" content="https://www.mattcarrier.com/post/diffing-docker-containers/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2023-06-15T00:00:00Z" />
  
  <meta property="og:article:tag" content="docker" />
  
  <meta property="og:article:tag" content="fish" />
  
  

  <title>
     Diffing contents of docker containers &middot;  Matt Carrier
  </title>

  <link rel="stylesheet" href="https://www.mattcarrier.com/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/main.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/github.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" type="text/css">

  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icon/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/icon/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/icon/manifest.json">
  <link rel="shortcut icon" href="/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="msapplication-config" content="/icon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

</head>
<body>
    <header class="global-header"  style="background-image:url( /images/bg.jpg )">
    <section class="header-text">
      <h1><a href="https://www.mattcarrier.com/">Matt Carrier</a></h1>
      
      <div class="tag-line">
        Bits &amp; Pixels
      </div>
      
      <div class="sns-links hidden-print">
  
  
  
  
  
  
  <a href="https://github.com/icecreammatt" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://stackoverflow.com/users/873559" target="_blank">
    <i class="fa fa-stack-overflow"></i>
  </a>
  
  
  <a href="https://linkedin.com/in/carriermatt" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="/resume">
    <i class="fa fa-file-o"></i>
  </a>
  
</div>

    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Diffing contents of docker containers</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2023-06-15T00:00:00Z">
          Jun 15, 2023
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://www.mattcarrier.com/tags/docker">#docker</a></span>
        
        <span class="post-tag small"><a href="https://www.mattcarrier.com/tags/fish">#fish</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>Recently I worked on a project where a large refactor had taken place but I wanted to ensure that there was no changes to the built output of the docker container. So while the diff in Github was quite large with many files moved around the output should remain almost identical aside from a few extra files removed.</p>
<p>To diff these containers I used the following methods:</p>
<ul>
<li><code>mkdir temp &amp;&amp; cd temp</code></li>
<li><code>docker cp $IMAGE_NAME_A:/application/path .</code></li>
<li><code>git init &amp;&amp; git add . &amp;&amp; git commit -m &quot;initial commit&quot;</code></li>
<li><code>docker cp $IMAGE_NAME_B:/application/path .</code></li>
<li><code>git status &amp;&amp; git diff</code></li>
</ul>
<p>This work by dumping the contents of the first image (what is currently in prod) and then checking it into git for diffing and next coping contents of the replacement image over it. In this case I didn&rsquo;t need to diff the entire containr image so I only did the application output. This will show new additions and changes but it will not show removed files. So next I ded the same thing but in reverse to see any files that might hav been removed. So dump <code>$IMAGE_NAME_B</code> first and then copy the contents of <code>$IMAGE_NAME_A</code> on top of it. Files which are removed will show up as additions when running <code>git status</code>. In my case they were template files I didn&rsquo;t want in the final output.</p>
<blockquote>
<p>Fish alias I setup to make this easy
ddmp (docker dump)</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ddmp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;set image (docker ps | grep &lt;CONTAINER_NAME_HERE&gt; | choose -1) &amp;&amp; docker cp </span>$image<span style="color:#e6db74">:/etc/nginx/ .&#34;</span>;
</span></span></code></pre></div>
  </section>
  <footer>
    
    
    
    <section class="author-info row">
      <div class="author-avatar col-md-2 col-sm-2 col-xs-12">
        
        <img alt="Author Avatar" src="/images/avatar.jpg" />
        
      </div>
      <div class="author-meta col-md-10 col-sm-10 col-xs-12">
        
        <h1 class="author-name text-primary">Matt Carrier</h1>
        
        
        <div class="author-bio">I am a pixel connoisseur who enjoys the finer details of a Bresenham line. When not staring at arrays of smoothly rendered pixels I enjoy playing guitar and consuming coffee.</div>
        
      </div>
      
    </section>
    <ul class="pager">
      
      <li class="previous"><a href="https://www.mattcarrier.com/post/export-pdf-to-png/"><span aria-hidden="true">&larr;</span>Older</a></li>
      
      
      <li class="next"><a href="https://www.mattcarrier.com/post/resume/">Newer<span aria-hidden="true">&rarr;</span></a></li>
      
    </ul>
  </footer>
</article>

  
<aside>
    <div class="row top-buffer">

      
        
          <div class="col-xs-12 col-sm-8 col-md-8">
        
              <div class="panel panel-default">
                  <div class="panel-heading">
                      <h2 class="panel-title">Recent Posts</h2>
                  </div>
                  <div class="list-group">
                      
                        
                          <a href="/post/poetry2nix/" class="list-group-item">Packaging python app with poetry2nix using nix flakes</a>
                         
                      
                         
                      
                        
                          <a href="/post/diffing-docker-containers/" class="list-group-item">Diffing contents of docker containers</a>
                         
                      
                        
                          <a href="/post/export-pdf-to-png/" class="list-group-item">Export PDFs to PNGs</a>
                         
                      
                        
                          <a href="/post/blender-set-frame-plugin/" class="list-group-item">Blender Set Frame Plugin</a>
                         
                      
                        
                          <a href="/post/nix-hostname/" class="list-group-item">Nix flake hostname troubleshooting</a>
                         
                      
                        
                          <a href="/post/nix-flake-for-build-environments/" class="list-group-item">Nix flakes for development</a>
                         
                      
                        
                          <a href="/post/hacking-the-winkhub-part-3/" class="list-group-item">Cross compiling Go for Winkhub</a>
                         
                       
                  </div>
              </div>
          </div>
      

      
        <div class="col-xs-12 col-sm-4 col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Tags</h2>
                </div>
                <div class="list-group">
                    
                    
                    <a href="https://www.mattcarrier.com/tags/archive" class="list-group-item">
                        <span class="badge">35</span>
                        archive
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/blender" class="list-group-item">
                        <span class="badge">1</span>
                        blender
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/coreos" class="list-group-item">
                        <span class="badge">1</span>
                        coreos
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/docker" class="list-group-item">
                        <span class="badge">2</span>
                        docker
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/entertainment" class="list-group-item">
                        <span class="badge">1</span>
                        entertainment
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/fish" class="list-group-item">
                        <span class="badge">2</span>
                        fish
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/flakes" class="list-group-item">
                        <span class="badge">3</span>
                        flakes
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/go" class="list-group-item">
                        <span class="badge">1</span>
                        go
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/imagemagick" class="list-group-item">
                        <span class="badge">1</span>
                        imagemagick
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/ios" class="list-group-item">
                        <span class="badge">2</span>
                        ios
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/iptables" class="list-group-item">
                        <span class="badge">1</span>
                        iptables
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/javascript" class="list-group-item">
                        <span class="badge">1</span>
                        javascript
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/linux" class="list-group-item">
                        <span class="badge">8</span>
                        linux
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/nix" class="list-group-item">
                        <span class="badge">4</span>
                        nix
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/osx" class="list-group-item">
                        <span class="badge">4</span>
                        osx
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/python" class="list-group-item">
                        <span class="badge">3</span>
                        python
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/systemd" class="list-group-item">
                        <span class="badge">1</span>
                        systemd
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/toolong" class="list-group-item">
                        <span class="badge">1</span>
                        toolong
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/vertigo" class="list-group-item">
                        <span class="badge">2</span>
                        vertigo
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/video-editing" class="list-group-item">
                        <span class="badge">1</span>
                        video-editing
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/winkhub" class="list-group-item">
                        <span class="badge">3</span>
                        winkhub
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/xcode" class="list-group-item">
                        <span class="badge">2</span>
                        xcode
                    </a>
                    
                </div>
            </div>
        </div>
      

    </div>
</aside>

  </main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
      &copy; Copyright 2024
    </div>
    <div class="sns-links hidden-print">
  
  
  
  
  
  
  <a href="https://github.com/icecreammatt" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://stackoverflow.com/users/873559" target="_blank">
    <i class="fa fa-stack-overflow"></i>
  </a>
  
  
  <a href="https://linkedin.com/in/carriermatt" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="/resume">
    <i class="fa fa-file-o"></i>
  </a>
  
</div>

  </footer>

  <script src="https://www.mattcarrier.com/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-25927979-1', 'auto');
    ga('send', 'pageview');
  </script>
  
  
</body>
</html>

