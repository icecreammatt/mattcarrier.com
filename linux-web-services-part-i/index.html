<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Linux web services Part I &middot;  Matt Carrier" />
  
  <meta property="og:site_name" content="Matt Carrier" />
  <meta property="og:url" content="https://www.mattcarrier.com/linux-web-services-part-i/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2014-07-11T00:00:00Z" />
  
  <meta property="og:article:tag" content="linux" />
  
  

  <title>
     Linux web services Part I &middot;  Matt Carrier
  </title>

  <link rel="stylesheet" href="https://www.mattcarrier.com/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/main.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://www.mattcarrier.com/css/github.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" type="text/css">

  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icon/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/icon/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/icon/manifest.json">
  <link rel="shortcut icon" href="/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="msapplication-config" content="/icon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

</head>
<body>
    <header class="global-header"  style="background-image:url( /images/bg.jpg )">
    <section class="header-text">
      <h1><a href="https://www.mattcarrier.com/">Matt Carrier</a></h1>
      
      <div class="tag-line">
        Bits &amp; Pixels
      </div>
      
      <div class="sns-links hidden-print">
  
  
  
  
  
  
  <a href="https://github.com/icecreammatt" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://stackoverflow.com/users/873559" target="_blank">
    <i class="fa fa-stack-overflow"></i>
  </a>
  
  
  <a href="https://linkedin.com/in/carriermatt" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="/resume">
    <i class="fa fa-file-o"></i>
  </a>
  
</div>

    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Linux web services Part I</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2014-07-11T00:00:00Z">
          Jul 11, 2014
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://www.mattcarrier.com/tags/linux">#linux</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>This is an introduction to a series of talks about setting up Linux servers. I&rsquo;m going to make the assumptions that you already have some experience at the command line whether it is Mac or Windows so I will not be explaining basic commands in order to keep these talks with in a one-hour time frame. This talk will be done with the assumption you are using a Mac, but you can also follow along using <a href="http://cygwin.com">cygwin</a> on Windows.</p>
<p>Resources for this talk are available here <a href="https://github.com/icecreammatt/server-setup">https://github.com/icecreammatt/server-setup</a></p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li>Public Private Key Creation</li>
<li>Instance Creation (DigitalOcean)</li>
<li>SSH Connection</li>
<li>Lockdown</li>
<li>Update &amp; Upgrade</li>
<li>Software Installation</li>
<li>Configuration &amp; Debugging</li>
<li>Shell Scripting</li>
<li>Git</li>
<li>Gotchas</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>OSX Terminal or <a href="http://cygwin.com">Cygwin</a></li>
<li><a href="https://www.digitalocean.com">DigitalOcean</a> hosting account or access to a fresh Ubuntu 14.04 install</li>
</ul>
<h2 id="public-private-keys">Public Private Keys</h2>
<p>To securely connect to a server we must not rely on passwords. So instead we use public/private key authentication. Using the same public keys that git uses for SSH we can also login to remote servers we configure to accept our key.</p>
<h3 id="key-generation">Key Generation</h3>
<p>Before generating a key check to see if you don&rsquo;t already have one.<br>
If the output looks like below you can just use the existing public key to connect to the new server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ls ~/.ssh
</span></span><span style="display:flex;"><span>id_rsa      id_rsa.pub
</span></span></code></pre></div><p>Otherwise generate a new public private key pair.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh-keygen -t rsa -C <span style="color:#e6db74">&#34;name@example.com&#34;</span>
</span></span><span style="display:flex;"><span>Generating public/private rsa key pair.
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#f92672">(</span>/Users/matt/.ssh/id_rsa<span style="color:#f92672">)</span>: id_rsa_example
</span></span><span style="display:flex;"><span>Enter passphrase <span style="color:#f92672">(</span>empty <span style="color:#66d9ef">for</span> no passphrase<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>Enter same passphrase again:
</span></span><span style="display:flex;"><span>Your identification has been saved in id_rsa_example.
</span></span><span style="display:flex;"><span>Your public key has been saved in id_rsa_example.pub.
</span></span><span style="display:flex;"><span>The key fingerprint is:
</span></span><span style="display:flex;"><span>e5:03:12:9c:40:7e:f3:f9:39:4c:1f:0b:07:04:7f:bd name@example.com
</span></span><span style="display:flex;"><span>The key<span style="color:#960050;background-color:#1e0010">&#39;</span>s randomart image is:
</span></span><span style="display:flex;"><span>+--<span style="color:#f92672">[</span> RSA 2048<span style="color:#f92672">]</span>----+
</span></span><span style="display:flex;"><span>|   .oo.....      |
</span></span><span style="display:flex;"><span>|   .  o. o   .   |
</span></span><span style="display:flex;"><span>|    . + . + . .  |
</span></span><span style="display:flex;"><span>|     . + <span style="color:#f92672">=</span> o   . |
</span></span><span style="display:flex;"><span>|        S <span style="color:#f92672">=</span> o E  |
</span></span><span style="display:flex;"><span>|         + * o   |
</span></span><span style="display:flex;"><span>|          <span style="color:#f92672">=</span> o    |
</span></span><span style="display:flex;"><span>|           .     |
</span></span><span style="display:flex;"><span>|                 |
</span></span><span style="display:flex;"><span>+-----------------+
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>id_rsa_example     id_rsa_example.pub
</span></span></code></pre></div><blockquote>
<p>The command below is specific to OSX and will not work in Cygwin<br>
Copy the contents of the public key to the clipboard</p>
</blockquote>
<p><strong>IMPORTANT!</strong> Be sure to copy the file that ends in &ldquo;.pub&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ pbcopy &lt; id_rsa_example.pub
</span></span></code></pre></div><blockquote>
<p>If using cygwin navigate to <code>C:\cygwin\home\username\.ssh\</code><br>
Open <code>id_rsa_example.pub</code> in a text editor to copy the contents</p>
</blockquote>
<pre tabindex="0"><code>$ cat id_rsa_example.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDoROCEGpranbMr7Uj9Un3zPZAtYA4VgEqinTNSOnsJ5+oxpMrW0sV8/AUial3hxGVJK/UFsURmjGWg0liN9CGwNrnwGufDyG/SBpbRdFk8jwxLXQgiyTjbrNKlhhK0AWFTeajPsoXHE1jycEu4/G1oaewQ+se7055qsN3RIFLkpYj0VSsy/fjaZH5BPk+NtFQOc7yO7Nqs+x7nORsoLVyie2YhQSzzFBM23RMFmnf6qdrdARKwm98J8tpUqkILzCas9NG679fPxHMHGw/b2QPLr0I3LblE4c1IcIXIQPTniEm5lMjWkw7Ggf4AEg1PbWLcb5MvUwGuo8k6+ZsS1tYh name@example.com
</code></pre><h3 id="uploading-keys">Uploading Keys</h3>
<ol>
<li>Login to DigitalOcean</li>
<li>On the DigitalOcean dashboard select SSH Keys</li>
<li>Add SSH Key</li>
<li>Enter a name for it and paste the contents into the body.</li>
<li>Create SSH Key</li>
</ol>
<h2 id="instance-creation-create-droplet">Instance Creation (Create Droplet)</h2>
<blockquote>
<p>DigitalOcean calls each server instance a &ldquo;droplet&rdquo;</p>
</blockquote>
<p><img src="/images/2014-07-11/permanence.png" alt="xkcd.com/910"></p>
<ol>
<li>Click Create Droplet</li>
<li>Enter a hostname for your server</li>
<li>Select a size (I recommend 512MB RAM for starting)</li>
<li>Select Region</li>
<li>Select Image Ubuntu 14.04 x64 (LTS)</li>
<li>Add your key, which was uploaded earlier</li>
<li>Create Droplet</li>
</ol>
<h2 id="ssh-connection">SSH Connection</h2>
<p>Once the loading bar has completed and we have an IP address we are ready to connect to the server.</p>
<p>We can connect to the server using the <code>ssh</code> command. Our public key has been automatically added to the server from the DigitalOcean control panel so our private key will work as the &ldquo;password&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh root@107.170.203.120
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;107.170.203.120 (107.170.203.120)&#39;</span> can<span style="color:#960050;background-color:#1e0010">&#39;</span>t be established.
</span></span><span style="display:flex;"><span>RSA key fingerprint is 5b:13:e0:0e:d9:44:5a:1a:49:b5:12:0e:3c:d4:0d:8d.
</span></span><span style="display:flex;"><span>Are you sure you want to <span style="color:#66d9ef">continue</span> connecting <span style="color:#f92672">(</span>yes/no<span style="color:#f92672">)</span>?yes
</span></span></code></pre></div><p>After connecting you should see this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Warning: Permanently added <span style="color:#e6db74">&#39;107.170.203.120&#39;</span> <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span> to the list of known hosts.
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 14.04 LTS <span style="color:#f92672">(</span>GNU/Linux 3.13.0-24-generic x86_64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> * Documentation:  https://help.ubuntu.com/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  System information as of Fri Jul <span style="color:#ae81ff">11</span> 01:06:53 EDT <span style="color:#ae81ff">2014</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  System load:  0.0               Processes:           <span style="color:#ae81ff">71</span>
</span></span><span style="display:flex;"><span>  Usage of /:   6.1% of 19.56GB   Users logged in:     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Memory usage: 9%                IP address <span style="color:#66d9ef">for</span> eth0: 107.170.203.120
</span></span><span style="display:flex;"><span>  Swap usage:   0%
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Graph this data and manage this system at:
</span></span><span style="display:flex;"><span>    https://landscape.canonical.com/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@setup-demo:~#
</span></span></code></pre></div><h2 id="lockdown">Lockdown</h2>
<p>We are now logged into the server, which right now is almost wide open to the Internet. It is time to lock it down with the following steps:</p>
<h3 id="user-account-creation">User account creation</h3>
<p>Create a sudo user account</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>username<span style="color:#f92672">=</span>YOUR_NAME_HERE
</span></span><span style="display:flex;"><span>addgroup admin
</span></span><span style="display:flex;"><span>adduser $username
</span></span><span style="display:flex;"><span>usermod -a -G admin $username
</span></span></code></pre></div><p>Full output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  root@setup-demo:~# username<span style="color:#f92672">=</span>matt
</span></span><span style="display:flex;"><span>  root@setup-demo:~# addgroup admin
</span></span><span style="display:flex;"><span>  Adding group <span style="color:#e6db74">`</span>admin<span style="color:#e6db74">&#39; (GID 1000) ...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Done.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  root@setup-demo:~# adduser $username
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Adding user `matt&#39;</span> ...
</span></span><span style="display:flex;"><span>  Adding new group <span style="color:#e6db74">`</span>matt<span style="color:#e6db74">&#39; (1001) ...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Adding new user `matt&#39;</span> <span style="color:#f92672">(</span>1000<span style="color:#f92672">)</span> with group <span style="color:#e6db74">`</span>matt<span style="color:#e6db74">&#39; ...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Creating home directory `/home/matt&#39;</span> ...
</span></span><span style="display:flex;"><span>  Copying files from <span style="color:#e6db74">`</span>/etc/skel<span style="color:#960050;background-color:#1e0010">&#39;</span> ...
</span></span><span style="display:flex;"><span>  Enter new UNIX password:
</span></span><span style="display:flex;"><span>  Retype new UNIX password:
</span></span><span style="display:flex;"><span>  passwd: password updated successfully
</span></span><span style="display:flex;"><span>  Changing the user information <span style="color:#66d9ef">for</span> matt
</span></span><span style="display:flex;"><span>  Enter the new value, or press ENTER <span style="color:#66d9ef">for</span> the default
</span></span><span style="display:flex;"><span>  	Full Name <span style="color:#f92672">[]</span>: Matt Carrier
</span></span><span style="display:flex;"><span>  	Room Number <span style="color:#f92672">[]</span>:
</span></span><span style="display:flex;"><span>  	Work Phone <span style="color:#f92672">[]</span>:
</span></span><span style="display:flex;"><span>  	Home Phone <span style="color:#f92672">[]</span>:
</span></span><span style="display:flex;"><span>  	Other <span style="color:#f92672">[]</span>:
</span></span><span style="display:flex;"><span>  Is the information correct? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  root@setup-demo:~# usermod -a -G admin $username
</span></span></code></pre></div><p>Copy over SSH public key to new account and set permissions to the owner</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /home/$username/.ssh/
</span></span><span style="display:flex;"><span>cp ~/.ssh/authorized_keys /home/$username/.ssh/authorized_keys
</span></span><span style="display:flex;"><span>chmod -R <span style="color:#ae81ff">750</span> /home/$username
</span></span><span style="display:flex;"><span>chown -R $username:$username /home/$username/
</span></span></code></pre></div><h3 id="ssh-server-lockdown">SSH Server lockdown</h3>
<ol start="2">
<li>
<p>Disable password authentication</p>
<p><code>echo &quot;PasswordAuthentication no&quot; &gt;&gt; /etc/ssh/sshd_config</code></p>
</li>
<li>
<p>Disable root login</p>
</li>
</ol>
<pre tabindex="0"><code>sed -i &#39;s/PermitRootLogin without-password/PermitRootLogin no/g&#39; /etc/ssh/sshd_config
sed -i &#39;s/PermitRootLogin yes/PermitRootLogin no/g&#39; /etc/ssh/sshd_config
sed -i &#39;s/PasswordAuthentication yes/PasswordAuthentication no/g&#39; /etc/ssh/sshd_config
</code></pre><ol start="4">
<li>Only allow login from selected users</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;AllowUsers </span>$username<span style="color:#e6db74">&#34;</span> &gt;&gt; /etc/ssh/sshd_config
</span></span></code></pre></div><ol start="5">
<li>Restart ssh server</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>service ssh restart
</span></span></code></pre></div><h3 id="firewall--fail2ban">Firewall &amp; fail2ban</h3>
<ol start="5">
<li>Setup ufw (Ubuntu Firewall)</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#75715e"># ufw (Ubuntu Firewall)</span>
</span></span><span style="display:flex;"><span>    ufw default deny incoming
</span></span><span style="display:flex;"><span>    ufw default allow outgoing
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Open SSH</span>
</span></span><span style="display:flex;"><span>    ufw allow ssh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Open web ports</span>
</span></span><span style="display:flex;"><span>    ufw allow 443/tcp
</span></span><span style="display:flex;"><span>    ufw allow 80/tcp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Enable firewall and fail2ban</span>
</span></span><span style="display:flex;"><span>    ufw --force enable
</span></span></code></pre></div><ol start="6">
<li>Setup fail2ban</li>
</ol>
<p><code>apt-get install -y fail2ban</code></p>
<ol start="8">
<li>Confirm status</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    root@setup-demo:~# ufw status
</span></span><span style="display:flex;"><span>    Status: active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    To                         Action      From
</span></span><span style="display:flex;"><span>    --                         ------      ----
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">22</span>                         ALLOW       Anywhere
</span></span><span style="display:flex;"><span>    443/tcp                    ALLOW       Anywhere
</span></span><span style="display:flex;"><span>    80/tcp                     ALLOW       Anywhere
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">22</span> <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>                    ALLOW       Anywhere <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    443/tcp <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>               ALLOW       Anywhere <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    80/tcp <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>                ALLOW       Anywhere <span style="color:#f92672">(</span>v6<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    root@setup-demo:~# service fail2ban status
</span></span><span style="display:flex;"><span>     * Status of authentication failure monitor
</span></span><span style="display:flex;"><span>     *  fail2ban is running
</span></span></code></pre></div><ol start="7">
<li>Ensure you can connect from a <strong>new terminal window</strong> before disconnecting</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    $ ssh YOUR_USERNAME@SERVER_IP
</span></span></code></pre></div><h2 id="updating--upgrading">Updating &amp; Upgrading</h2>
<ol>
<li>
<p>Set the time zone to your choice</p>
<blockquote>
<p>NOTE: I had to run <code>$ tzconfig</code> before the above command would work for me.</p>
</blockquote>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    $ dpkg-reconfigure tzdata
</span></span></code></pre></div><ol start="2">
<li>
<p>Update server to latest software</p>
<blockquote>
<p><code>apt-get update</code> will fetch all the latest updates.<br>
<code>apt-get upgrade</code> will apply updates.</p>
</blockquote>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    $ apt-get update <span style="color:#f92672">&amp;&amp;</span> apt-get upgrade -y
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Make sure you are able to reconnect from a new window before this step</span>
</span></span><span style="display:flex;"><span>    $ shutdown -r now
</span></span></code></pre></div><h2 id="software-installation">Software Installation</h2>
<p><img src="/images/2014-07-11/sandwich.png" alt=""></p>
<p>Basic utilities to install</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt-get install -y htop zsh tree git vim nginx nodejs make npm cmake python-dev
</span></span></code></pre></div><ul>
<li>htop - processor monitor</li>
<li>tree - tree view directories</li>
<li>git - the stupid content tracker</li>
<li>vim - text editor</li>
<li>nginx - web server / reverse proxy</li>
<li>make - build tools</li>
<li>cmake - more build tools</li>
<li>python-dev - even more building tools</li>
</ul>
<h2 id="configuration--debugging">Configuration &amp; Debugging</h2>
<ul>
<li>
<p>nginx - <code>sudo vim /etc/nginx/sites-enabled/default</code><br>
<code>sudo service nginx restart</code></p>
</li>
<li>
<p>ssh - <code>sudo vim /etc/ssh/sshd_config</code><br>
<code>sudo service ssh restart</code></p>
</li>
<li>
<p>logs<code>/var/log</code><br>
<code>sudo tail -f /var/log/nginx/access.log</code></p>
</li>
</ul>
<h2 id="shell-scripting">Shell Scripting</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is a comment</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Hello World&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># make script executable</span>
</span></span><span style="display:flex;"><span>chmod a+x hello.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># execute script</span>
</span></span><span style="display:flex;"><span>./hello.sh
</span></span></code></pre></div><h2 id="git-remote-repository">Git remote repository</h2>
<p>On the remote machine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ mkdir ~/web-project-name.git
</span></span><span style="display:flex;"><span>$ git init --bare ~/web-project-name.git
</span></span></code></pre></div><p>From local machine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd ~/projects/web-project
</span></span><span style="display:flex;"><span>$ git remote add web-hostname YOUR_USERNAME@SERVER_IP:web-project-name.git
</span></span><span style="display:flex;"><span>$ git push web-hostname master
</span></span></code></pre></div><ul>
<li>Githooks
<ul>
<li>post-update for deployment</li>
</ul>
</li>
</ul>
<blockquote>
<p>Challenge: Setup the git post-update hook to deploy website</p>
</blockquote>
<h2 id="gotchas">Gotchas</h2>
<ul>
<li>ctrl + z by accident?
<ul>
<li>fg to foreground the application</li>
</ul>
</li>
</ul>
<h2 id="nodejs-with-nginx">NodeJS with Nginx</h2>
<ul>
<li>Add a site config to <code>/etc/nginx/sites-available/site.conf</code>.
  <script src="https://gist.github.com/icecreammatt/b9252556400e08513c61.js"></script>
</li>
<li>Soft link <code>ln -s /etc/nginx/sites-available/site.conf /etc/nginx/sites-enabled/</code> to enable the site.</li>
<li><code>sudo service nginx reload</code> to apply the changes.</li>
<li>Change the port number from <code>3000</code> to whatever your node app is running on.</li>
</ul>
<h2 id="next-time">Next time</h2>
<ul>
<li>Automation
<ul>
<li>Ansible</li>
</ul>
</li>
<li>PaaS</li>
<li>Docker</li>
<li>Dokku</li>
</ul>
<h2 id="future-talk-ideas">Future talk ideas</h2>
<ul>
<li>Nginx Setup with NodeJS</li>
<li>DNS</li>
<li>Monitoring</li>
<li>Automation deep dive</li>
<li>AWS
<ul>
<li>Basics</li>
<li>Security Groups</li>
<li>EC2</li>
<li>Load Balancing</li>
<li>etc&hellip;</li>
</ul>
</li>
<li>Continuous Integration</li>
</ul>

  </section>
  <footer>
    
    
    
    <section class="author-info row">
      <div class="author-avatar col-md-2 col-sm-2 col-xs-12">
        
        <img alt="Author Avatar" src="/images/avatar.jpg" />
        
      </div>
      <div class="author-meta col-md-10 col-sm-10 col-xs-12">
        
        <h1 class="author-name text-primary">Matt Carrier</h1>
        
        
        <div class="author-bio">I am a pixel connoisseur who enjoys the finer details of a Bresenham line. When not staring at arrays of smoothly rendered pixels I enjoy playing guitar and consuming coffee.</div>
        
      </div>
      
    </section>
    <ul class="pager">
      
      <li class="previous"><a href="https://www.mattcarrier.com/tools-and-plugins-for-osx/"><span aria-hidden="true">&larr;</span>Older</a></li>
      
      
      <li class="next"><a href="https://www.mattcarrier.com/post/enable-surround-sound-hdmi-osx/">Newer<span aria-hidden="true">&rarr;</span></a></li>
      
    </ul>
  </footer>
</article>

  
<aside>
    <div class="row top-buffer">

      
        
          <div class="col-xs-12 col-sm-8 col-md-8">
        
              <div class="panel panel-default">
                  <div class="panel-heading">
                      <h2 class="panel-title">Recent Posts</h2>
                  </div>
                  <div class="list-group">
                      
                        
                          <a href="/post/export-pdf-to-png/" class="list-group-item">Export PDFs to PNGs</a>
                         
                      
                        
                          <a href="/post/blender-set-frame-plugin/" class="list-group-item">Blender Set Frame Plugin</a>
                         
                      
                        
                          <a href="/post/nix-hostname/" class="list-group-item">Nix flake hostname troubleshooting</a>
                         
                      
                        
                          <a href="/post/nix-flake-for-build-environments/" class="list-group-item">Nix flakes for development</a>
                         
                      
                         
                      
                        
                          <a href="/post/hacking-the-winkhub-part-3/" class="list-group-item">Cross compiling Go for Winkhub</a>
                         
                      
                        
                          <a href="/post/hacking-the-winkhub-part-2/" class="list-group-item">Troubleshooting Winkhub issues</a>
                         
                      
                        
                          <a href="/post/hacking-the-winkhub-part-1/" class="list-group-item">Hacking the Winkhub</a>
                         
                       
                  </div>
              </div>
          </div>
      

      
        <div class="col-xs-12 col-sm-4 col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">Tags</h2>
                </div>
                <div class="list-group">
                    
                    
                    <a href="https://www.mattcarrier.com/tags/archive" class="list-group-item">
                        <span class="badge">35</span>
                        archive
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/blender" class="list-group-item">
                        <span class="badge">1</span>
                        blender
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/coreos" class="list-group-item">
                        <span class="badge">1</span>
                        coreos
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/docker" class="list-group-item">
                        <span class="badge">1</span>
                        docker
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/entertainment" class="list-group-item">
                        <span class="badge">1</span>
                        entertainment
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/fish" class="list-group-item">
                        <span class="badge">1</span>
                        fish
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/flakes" class="list-group-item">
                        <span class="badge">2</span>
                        flakes
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/go" class="list-group-item">
                        <span class="badge">1</span>
                        go
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/imagemagick" class="list-group-item">
                        <span class="badge">1</span>
                        imagemagick
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/ios" class="list-group-item">
                        <span class="badge">2</span>
                        ios
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/iptables" class="list-group-item">
                        <span class="badge">1</span>
                        iptables
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/javascript" class="list-group-item">
                        <span class="badge">1</span>
                        javascript
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/linux" class="list-group-item">
                        <span class="badge">7</span>
                        linux
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/nix" class="list-group-item">
                        <span class="badge">3</span>
                        nix
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/osx" class="list-group-item">
                        <span class="badge">4</span>
                        osx
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/python" class="list-group-item">
                        <span class="badge">2</span>
                        python
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/systemd" class="list-group-item">
                        <span class="badge">1</span>
                        systemd
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/vertigo" class="list-group-item">
                        <span class="badge">2</span>
                        vertigo
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/video-editing" class="list-group-item">
                        <span class="badge">1</span>
                        video-editing
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/winkhub" class="list-group-item">
                        <span class="badge">3</span>
                        winkhub
                    </a>
                    
                    <a href="https://www.mattcarrier.com/tags/xcode" class="list-group-item">
                        <span class="badge">2</span>
                        xcode
                    </a>
                    
                </div>
            </div>
        </div>
      

    </div>
</aside>

  </main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
      &copy; Copyright 2023
    </div>
    <div class="sns-links hidden-print">
  
  
  
  
  
  
  <a href="https://github.com/icecreammatt" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://stackoverflow.com/users/873559" target="_blank">
    <i class="fa fa-stack-overflow"></i>
  </a>
  
  
  <a href="https://linkedin.com/in/carriermatt" target="_blank">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="/resume">
    <i class="fa fa-file-o"></i>
  </a>
  
</div>

  </footer>

  <script src="https://www.mattcarrier.com/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-25927979-1', 'auto');
    ga('send', 'pageview');
  </script>
  
  
</body>
</html>

